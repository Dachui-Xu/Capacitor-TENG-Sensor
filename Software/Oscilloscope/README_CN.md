### 项目需求说明书：串口示波器

**项目概述**：本项目旨在开发一个功能全面的串口示波器，用于接收和显示串口数据，包括波形数据和非波形数据。该示波器需能够处理指定格式的数据，并实现对CAP（电容）和ADC（模数转换）数据的灵活显示和分析。

#### 1. **数据输入与格式**
- **输入数据格式**：
  ```
  CAP,9089,8800,9248,9903
  ADC,1589,1610,1600,1577,1606,1621,1605,1609,1619,1618
  ```
  - 每一行数据以CAP或ADC开头，后跟多个逗号分隔的数值。
  
- **数据类型**：
  
  - `CAP` 数据代表电容值，单位为皮法（fF）。
  - `ADC` 数据代表模数转换结果，单位为伏特（V）。
  
- **数据处理规则**：
  - 接收到的每个数值在显示时都CAP值需除以3，转换为小数形式以便于阅读和分析。
  - 数据刷新率为**50Hz**，即20ms从串口获取一次数据。
  
#### 2. **基本功能需求**
- **实时数据绘制**：
  - 能够实时显示串口接收的数据波形，提供清晰、稳定的波形视图。
  - 支持CAP和ADC类型数据的波形绘制，并允许用户根据需求选择显示CAP、ADC或两者同时显示。
- **非波形数据显示**：
  - 在接收数据时，除了绘制波形外，能够在屏幕上展示未绘制的原始数据内容。
  
#### 3. **自适应与可调性**
- **自适应显示**：
  - 系统能够自动调整显示范围和缩放比例，确保波形在不同幅度下都能正确显示。
- **可调设置**：
  - 用户可手动设置CAP和ADC显示的通道数量：
    - CAP通道数量最大为4。
    - ADC通道数量最大为10。
    - 多余上述也成，但无法保证性能。
  - 用户可配置显示特性，例如：
    - 时间轴缩放。
    - 波形颜色、线条样式等。

#### 4. **交互与标签功能**
- **数据选择标签**：
  - 提供用户界面上的标签或选项，允许用户选择显示CAP数据、ADC数据或两者的组合。
- **用户交互**：
  - 支持简单的用户交互，例如切换显示模式、暂停/继续波形更新等。
  - 提供快捷键操作。

#### 5. **性能与优化**
- **数据刷新率**：
  - 支持高刷新率（50Hz）的数据更新，以确保实时显示无延迟。
- **性能优化**：
  - 通过多线程或异步处理提高数据接收与波形绘制的效率，避免界面卡顿。
- **稳定性**：
  - 处理噪声与异常数据，确保显示的稳定性和准确性。

#### **6.数据分类导出：**

- 根据数据类型（ADC或CAP）生成并导出为Excel文件。
- 用户可以选择导出CAP数据或ADC数据，或同时导出两种类型的数据。
- 导出的Excel文件应包含时间戳、数据类型、原始数据值及经过除以3的处理后数据。

- **导出格式：**
  - Excel文件结构清晰，包含数据的分类表格和适当的标注，以便于用户后续分析和使用。

#### 7.软件展示

![](img/main.png)